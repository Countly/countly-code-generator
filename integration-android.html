<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <link rel="shortcut icon" href="images/favicon.png">

    <title>Countly Code Generator</title>

    <!-- Bootstrap core CSS -->
    <link href="css/bootstrap.min.css" rel="stylesheet">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
</head>

<body>
    <div class="jumbotron top">
        <div class="container">
            <div id="logo">
                <span class="image"></span>
                <span class="text">Code Generator</span>
            </div>
        </div>
    </div>
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <div style="overflow: auto">
                    <div class="btn-group" style="float: left">
                        <a href="integration.html" id="back" class="btn btn-default">&larr; Back</a>
                        <a href="events.html?sdk=android" id="next" class="btn btn-default">Next: Create Event
                            &rarr;</a>
                    </div>
                    <div id="buttons" class="btn-group" role="group" style="float: right">

                    </div>
                </div>
                <h2 class="text-center">Integrating Android SDK</h2>
            </div>
        </div>
        <div class='section configuration'>
            <span class='label'>Provide configuration settings</span>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for='server-url'>Server URL:</label>
                        <input type="url" class="form-control" id='server-url' placeholder="https://your.server.ly">
                    </div>
                </div><!-- /.col-lg-6 -->
            </div>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="app_key">App Key:</label>
                        <input type="text" class="form-control" id="app_key"
                            placeholder="YOUR_APP_KEY">
                    </div>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
        </div>
        <div class='section ide radio'>
            <span class='label'>Choose your environment/IDE</span>
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="radio" name='ide' value='studio'> Android Studio
                    </label>
                </div><!-- /.col-lg-6 -->
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="radio" name='ide' value='eclipse'> Eclipse
                    </label>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
        </div>
        <div class='section features checkbox'>
            <span class='label'>Choose features you want to use</span>
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="checkbox" class='feature' id='push_feature' value='push'> Send push notifications
                        to your users
                    </label>
                </div><!-- /.col-lg-6 -->
            </div>
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="checkbox" class='feature' value='view'> Track views your users visit
                    </label>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="checkbox" class='feature' value='crash'> Track app crashes
                    </label>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="checkbox" class='feature' value='attribution'> Track campaigns and attribution
                    </label>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <p>&nbsp;</p>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <label>
                        <input type="checkbox" id="allfeatures"> I want all features
                    </label>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
        </div>
        <div class='section push-settings hidden'>
            <span class='label'>Provide push specific settings</span>
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="push_activity">Name of your main activity (the one specified in Android
                            Manifest):</label>
                        <input type="text" class="form-control" id="push_activity" placeholder="MainActivity">
                    </div>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="push_package">Name of your app package (the one specified in Android
                            Manifest):</label>
                        <input type="text" class="form-control" id="push_package"
                            placeholder="ly.count.android.demo.messaging">
                    </div>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
            <div class="row">
                <div class="col-md-12">
                    <div class="form-group">
                        <label for="push_msg_provider">Message provider type (FCM-[Firebase] or HMS-[Huawei Messaging]):</label>
                        <input type="text" class="form-control" id="push_msg_provider" list="providerList"
                            placeholder="FCM">
                        <datalist id="providerList">
                            <option value="FCM">  
                            <option value="HMS">
                            </datalist>
                    </div>
                </div><!-- /.col-lg-6 -->
            </div><!-- /.row -->
        </div>
        <div class='section advanced'>
            <span class='label'>
                <span id="dropdown-icon" style="display: inline-block;"></span>
                <span id="dropdown-icon-2" style="display: none;"></span>
                Advanced Configuration</span>
            <div class='advanced-list'>
                <fieldset>
                    <legend>Location</legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide country code of your user (will try to determine from IP address if not
                                    provided)</label>
                                <input type="text" class="form-control optlocation" id='country' placeholder="US" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide city of your user (will try to determine from IP address if not
                                    provided)</label>
                                <input type="text" class="form-control optlocation" id='city' placeholder="San Francisco" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide geolocation of your user (will try to determine from IP address if not
                                    provided)</label>
                                <input type="text" class="form-control optlocation" id='location'
                                    placeholder="56.42345,123.45325" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide IP of the user</label>
                                <input type="text" class="form-control optlocation" id='ip'
                                    placeholder="1.1.1.1" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                </fieldset>
                <fieldset>
                    <legend>Limits</legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Send events when you reach this limit without waiting for next sync</label>
                                <input type="text" class="form-control" id='setEventQueueSizeToSend' placeholder="10" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide the Star Rating dialog title</label>
                                <input type="text" class="form-control" id='setStarRatingTextTitle'
                                    placeholder="App rating" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide the Star Rating dialog message</label>
                                <input type="text" class="form-control" id='setStarRatingTextMessage'
                                    placeholder="Please rate this app" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide title for cancel button in Star Rating dialog</label>
                                <input type="text" class="form-control" id='setStarRatingTextDismiss'
                                    placeholder="Cancel" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Show Star rating dialog after this amount of sessions</label>
                                <input type="text" class="form-control" id='setAutomaticStarRatingSessionLimit'
                                    placeholder="10" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                </fieldset>
                <fieldset>
                    <legend>Optional</legend>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id='setIfStarRatingShownAutomatically' value='false'> Disable
                                    Asking Star rating completely
                                </label>
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id='setStarRatingDisableAskingForEachAppVersion'
                                        value='false'> Disable Asking Star rating for each version
                                </label>
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id='setLoggingEnabled' value='true'> Enable Debug logging
                                </label>
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>
                                    <input type="checkbox" id='setHttpPostForced' value='true'> Force using POST only
                                </label>
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                    <div class="row">
                        <div class="col-md-12">
                            <div class="form-group">
                                <label>Provide the secret salt. Must be same with the one provided on server to prevent
                                    changing request data</label>
                                <input type="text" class="form-control" id='setParameterTamperingProtectionSalt'
                                    placeholder="secret" />
                            </div>
                        </div><!-- /.col-lg-6 -->
                    </div><!-- /.row -->
                </fieldset>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <p class='text-center'><button type="button" class="btn btn-success" id="generate">Generate
                        code</button></p>
            </div><!-- /.col-lg-6 -->
        </div><!-- /.row -->

        <footer>
            <p><a href='http://count.ly'>Count.ly</a></p>
        </footer>
    </div> <!-- /container -->

    <div class="modal fade" id="end-modal" tabindex="-1" role="dialog">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                    <h4 class="modal-title">Integrate Android SDK</h4>
                </div>
                <div class="modal-body">
                    <div class="tabbable"> <!-- Only required for left/right tabs -->
                        <ul class="nav nav-tabs">
                            <li class="active"><a href="#adding" data-toggle="tab">Adding SDK files</a></li>
                            <li><a href="#activity" data-toggle="tab">Main Activity</a></li>
                            <li><a href="#manifest" data-toggle="tab">Android Manifest</a></li>
                        </ul>
                        <div class="tab-content">
                            <div class="tab-pane active" id="adding">
                                <div class='studio hidden'>
                                    <p>Add Maven repository and dependency to your app's level
                                        <strong>build.gradle</strong> file
                                    </p>
                                    <p><textarea id='gradle-code' class='code' readonly onclick="this.select();">
buildscript {
    repositories {
        mavenCentral()
    }
}

dependencies {
    implementation 'ly.count.android:sdk:version'
}
                                </textarea></p>
                                    <p class='text-center'>
                                        <button type="button" class="btn btn-success copy"
                                            data-clipboard-target="#gradle-code">Copy</button>&nbsp;
                                        <button type="button" class="btn btn-success"
                                            id="download-gradle">Download</button>&nbsp;
                                        <button type="button" class="btn btn-primary gotit">Close</button>
                                    </p>
                                </div>
                                <div class='eclipse hidden'>
                                    <div class='well'>
                                        Eclipse users can download JARs (sdk.jar or sdk.jar & sdk-messaging.jar
                                        depending on whether you need Countly Push support or not) from <a
                                            href='https://github.com/Countly/countly-sdk-android/releases'
                                            target='_blank'>Github Releases</a> page.
                                    </div>
                                    <p>Another option for Eclipse users is to use sources instead of jars. To do that,
                                        just create packages and put sources from Github repository into corresponding
                                        packages:</p>
                                    <table class="table">
                                        <tr>
                                            <th>Component</th>
                                            <th>Package name</th>
                                            <th>Path at Github repo</th>
                                        </tr>
                                        <tr>
                                            <td>Countly SDK</td>
                                            <td>ly.count.android.sdk</td>
                                            <td>countly-sdk-android/sdk/src/main/java/ly/count/android/sdk</td>
                                        </tr>
                                        <tr class='push-package hidden'>
                                            <td>Countly Push SDK</td>
                                            <td>ly.count.android.sdk.messaging</td>
                                            <td>countly-sdk-android/sdk/src/main/java/ly/count/android/sdk/messaging
                                            </td>
                                        </tr>
                                    </table>
                                    <p class='text-center'>
                                        <button type="button" class="btn btn-primary gotit">Close</button>
                                    </p>
                                </div>
                            </div>
                            <div class="tab-pane" id="activity">
                                <p>Insert this snippet (or modify it to include provided code in same methods) to your
                                    main activity, which is the first to launch and is specified in your Android
                                    manifest</p>
                                <p id='push' class='well'><a
                                        href="https://support.countly.com/hc/en-us/articles/360037754031-Android#h_01HAVQDM5TNGS4ZR4109W4S5TK"
                                        target="_blank">More information on setting up push notifications on server</a>
                                </p>
                                <p><textarea id='end-code' class='code' readonly onclick="this.select();"></textarea>
                                </p>
                                <p class='text-center'>
                                    <button type="button" class="btn btn-success copy"
                                        data-clipboard-target="#end-code">Copy</button>&nbsp;
                                    <button type="button" class="btn btn-success" id="download">Download</button>&nbsp;
                                    <button type="button" class="btn btn-primary gotit">Close</button>
                                </p>
                            </div>
                            <div class="tab-pane" id="manifest">
                                <p>Insert this snippet to in your <strong>AndroidManifest.xml</strong>, or modify it to
                                    include provided tags in same xmls structure</p>
                                <p><textarea id='manifest-code' class='code' readonly
                                        onclick="this.select();"></textarea></p>
                                <p class='text-center'>
                                    <button type="button" class="btn btn-success copy"
                                        data-clipboard-target="#manifest-code">Copy</button>&nbsp;
                                    <button type="button" class="btn btn-success"
                                        id="download-manifest">Download</button>&nbsp;
                                    <button type="button" class="btn btn-primary gotit">Close</button>
                                </p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <!-- Bootstrap core JavaScript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script>window.jQuery || document.write('<script src="js/jquery.min.js"><\/script>')</script>
    <script src="https://global.localizecdn.com/localize.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <script src="js/ie10-viewport-bug-workaround.js"></script>
    <script src="js/sdks.js"></script>
    <script src="js/common.js"></script>
    <script src="js/Blob.js"></script>
    <script src="js/FileSaver.min.js"></script>
    <script src="js/clipboard.min.js"></script>
    <script>
        $(document).ready(function () {
            new Clipboard('.copy');
            var sdk = sdks.android;
            $("#gradle-code").val($("#gradle-code").val().replace(":version", ":" + sdk.version));
            $("#buttons").append('<a href="' + sdk.docs + '" target="_blank" class="btn btn-default">Documentation</a>');
            $("#buttons").append('<a href="' + sdk.download + '" target="_blank" class="btn btn-default">Download</a>');
            $("#buttons").append('<a href="' + sdk.repo + '" target="_blank" class="btn btn-default">Repository</a>');

            var params = parseParams(location.search);
            if (params.server) {
                $("#server-url").val(params.server);
            }

            if (params.app_key) {
                $("#app_key").val(params.app_key);
            }

            if (params.server && params.app_key) {
                $(".configuration").hide();
            }

            $('#push_feature').change(function () {
                if ($(this).is(':checked')) {
                    $(".push-settings").removeClass("hidden");
                } else {
                    $(".push-settings").addClass("hidden");
                }
            });

            var template = "@Override\n" +
                "public void onCreate(Bundle savedInstanceState) {\n" +
                "   super.onCreate(savedInstanceState);\n" +
                "   \n" +
                "   CountlyConfig config = new CountlyConfig(this, \"YOUR_SERVER\", \"YOUR_APP_KEY\");\n" +
                "[options]\n" +
                "[features]\n" +
                "   Countly.sharedInstance().init(config);\n" +
                "}\n" +
                "\n" +
                "@Override\n" +
                "public void onStart()\n" +
                "{\n" +
                "   super.onStart();\n" +
                "   Countly.sharedInstance().onStart(this);\n" +
                "}\n" +
                "\n" +
                "@Override\n" +
                "public void onStop()\n" +
                "{\n" +
                "   Countly.sharedInstance().onStop();\n" +
                "   super.onStop();\n" +
                "}\n";

            $("#generate").click(function () {
                var pushPermission = 
                        "<uses-permission android:name=\"android.permission.POST_NOTIFICATIONS\"/>\n"+
                    "<uses-permission android:name=\"${applicationId}.CountlyPush.BROADCAST_PERMISSION\"/>\n";

                var attribution =
                    "   <receiver android:name=\"ly.count.android.sdk.ReferrerReceiver\" android:exported=\"true\">\n" +
                    "       <intent-filter>\n" +
                    "           <action android:name=\"com.android.vending.INSTALL_REFERRER\" />\n" +
                    "       </intent-filter>\n" +
                    "   </receiver>\n";

                var manifest = "<?xml version=\"1.0\" encoding=\"utf-8\"?>\n"+
                    "<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\" package=\"ly.count.android.demo.messaging\">\n"+
                        "<uses-permission android:name=\"android.permission.INTERNET\"/>\n" +
                    "<uses-permission android:name=\"android.permission.ACCESS_NETWORK_STATE\"/>\n" +
                    "\n";

                var manifestApplication = [];

                $(".alert").remove();
                var data = {};
                data.url = $("#server-url").val();

                if (data.url == "") {
                    $("#server-url").parent().prepend('<div class="alert alert-danger" role="alert">Please provide server URL</div>');
                    scrollToElement(".configuration");
                    return;
                }

                if (data.url.indexOf("http") != 0) {
                    $("#server-url").parent().prepend('<div class="alert alert-danger" role="alert">Your server URL should start with http:// or https://</div>');
                    scrollToElement(".configuration");
                    return;
                }

                data.app_key = $("#app_key").val();

                if (data.app_key == "") {
                    $("#app_key").parent().prepend('<div class="alert alert-danger" role="alert">Please provide App Key</div>');
                    scrollToElement(".configuration");
                    return;
                }

                data.ide = $("input:radio[name=ide]:checked").val();

                if (!data.ide || data.ide == "") {
                    $(".ide").prepend('<div class="alert alert-danger" role="alert">Please select one tool/IDE you will be using</div>');
                    scrollToElement(".ide");
                    return;
                }
                else {
                    if (data.ide == "studio") {
                        $(".studio").removeClass("hidden");
                        $(".eclipse").addClass("hidden");
                    }
                    else if (data.ide == "eclipse") {
                        $(".studio").addClass("hidden");
                        $(".eclipse").removeClass("hidden");
                    }
                }

                var features = $(".feature:checked").map(function (feature) {
                    return this.value;
                }).get();

                data.features = "";

                if (features.length) {
                    for (var i = 0; i < features.length; i++) {
                        if (features[i] == "push") {

                            var activity = $("#push_activity").val();
                            if (activity == "") {
                                $("#push_activity").parent().prepend('<div class="alert alert-danger" role="alert">Please provide name of the main activity. You can find it in your Android Manifest</div>');
                                return;
                            }

                            var pack = $("#push_package").val();
                            if (pack == "") {
                                $("#push_package").parent().prepend('<div class="alert alert-danger" role="alert">Please provide package name of your app. You can find it in your Android Manifest</div>');
                                return;
                            }

                            var msgProvider = $("#push_msg_provider").val();
                            if (msgProvider == "") {
                                msgProvider = "FCM";
                            }

                            pushPermission = pushPermission
                                .replace(new RegExp("ly.count.android.demo.messaging", 'g'), pack);

                            manifest = pushPermission + manifest;

                            pushFeature = "   List<String> allowedClassNames = new ArrayList<>();\n" +
                                          "   allowedClassNames.add(\"CountlyActivity\");\n" +
                                          "   \n" +
                                          "   List<String> allowedPackageNames = new ArrayList<>();\n" +
                                          "   allowedPackageNames.add(getPackageName());\n" +
                                          "   \n" +
                                          "   CountlyConfigPush countlyConfigPush = new CountlyConfigPush(this)\n" + 
                                          "       .setProvider(Countly.CountlyMessagingProvider.MSG_PROVIDER)\n" +
                                          "       .setAllowedIntentClassNames(allowedClassNames)\n" +
                                          "       .setAllowedIntentPackageNames(allowedPackageNames);\n" +
                                          "   \n" +
                                          "   CountlyPush.init(countlyConfigPush);\n";

                            pushFeature = pushFeature
                                .replace("CountlyActivity", activity)
                                .replace("MSG_PROVIDER", msgProvider);


                            data.features += pushFeature;
                            $(".push-package").removeClass("hidden");
                        }
                        else if (features[i] == "view") {
                            data.features += "   config.enableAutomaticViewTracking();\n";
                        }
                        else if (features[i] == "crash") {
                            data.features += "   config.crashes.enableCrashReporting();\n";
                        }
                        else if (features[i] == "attribution") {
                            manifestApplication.push(attribution);
                        }
                    }
                    if (features.indexOf("push") == -1) {
                        $("push").hide();
                    }
                }

                data.options = $(".advanced-list input").map(function (el) {
                    if (this.type == "text") {
                        if ($(this).hasClass("arr") && this.value.replace(/^\s+|\s+$/gm, '') != "") {
                            var arr = this.value.split(",");
                            for (var i = 0; i < arr.length; i++) {
                                arr[i] = '"' + arr[i].replace(/^\s+|\s+$/gm, '') + '"';
                            }
                            return { id: this.id, value: '[' + arr.join(",") + ']' };
                        }
                        else if ($(this).hasClass("optinit") || $(this).hasClass("star")) {
                            return { id: this.id, value: "" };
                        }
                        else if (isNaN(this.value))
                            return { id: this.id, value: '"' + (($(this).hasClass("context")) ? "context, " : "") + this.value + '"' };
                        else
                            return { id: this.id, value: (($(this).hasClass("context")) ? "context, " : "") + this.value };
                    }
                    else if (this.type == "checkbox" && this.checked)
                        return { id: this.id, value: (($(this).hasClass("context")) ? "context, " : "") + this.value };
                    else
                        return { id: this.id, value: "" };
                }).get().filter(function (el) {
                    if (el.value.length && el.value != '""')
                        return true;
                    return false;
                }).map(function (el) {
                    return "   config." + el.id + '(' + el.value + ');';
                });

                //process optional init
                var hasLocation = false;
                var optLocation = $(".advanced-list input.optlocation").map(function (el) {
                    if (this.value != "") {
                        hasLocation = true;
                        return '"' + this.value + '"';
                    }
                    return "null";
                }).get().join(", ");

                if (hasLocation) {
                    data.options.unshift("   config.setLocation(" + optLocation + ");");
                }

                if (data.options.length) {
                    data.options = data.options.join("\n") + "\n";
                }
                else {
                    data.options = "";
                }

                var code = template.replace("YOUR_SERVER", data.url)
                    .replace("YOUR_APP_KEY", data.app_key)
                    .replace("[options]", data.options)
                    .replace("[features]", data.features);

                if (features.indexOf("CLYMessaging") > -1) {
                    code = code.replace("   // your code\n", pushHandling);
                    code += "\n" + pushMethods;
                }

                if (manifestApplication.length) {
                    var application = "<application>";
                    if (data.ide == "studio") {
                        application = "<application tools:replace=\"android:label\">";
                    }
                    manifest = manifest + "\n" + application + "\n\n" + manifestApplication.join("\n") + "\n</application>\n";
                }

                $("#end-code").val(code);
                $("#manifest-code").val(manifest);
                $('#end-modal').modal();
            });

            $("#allfeatures").change(function () {
                $(".feature").prop('checked', $(this).prop("checked"));
                if ($(this).is(':checked')) {
                    $(".push-settings").removeClass("hidden");
                } else {
                    $(".push-settings").addClass("hidden");
                }
            });

            $(".gotit").click(function () {
                $('#end-modal').modal('hide');
            });

            $("#download").click(function () {
                var data = $("#end-code").val();
                try {
                    var blob = new Blob([data], { type: "text/plain;charset=utf-8" });
                    saveAs(blob, "android-sdk.txt");
                } catch (e) {
                    alert(data);
                }
            });

            $("#download-graddle").click(function () {
                var data = $("#gradle-code").val();
                try {
                    var blob = new Blob([data], { type: "text/plain;charset=utf-8" });
                    saveAs(blob, "build.gradle.txt");
                } catch (e) {
                    alert(data);
                }
            });

            $(".advanced span.label").on('click', function () {
                var downArrow = document.getElementById('dropdown-icon').style.display;
                if (downArrow === 'inline-block') {
                    $(this).parent().find("#dropdown-icon-2").attr('style', 'display: inline-block');
                }
                else {
                    $(this).parent().find("#dropdown-icon-2").attr('style', 'display: none');
                }
                $(this).parent().find("#dropdown-icon").toggle();
            });

            $("#download-manifest").click(function () {
                var data = $("#manifest-code").val();
                try {
                    var blob = new Blob([data], { type: "text/plain;charset=utf-8" });
                    saveAs(blob, "AndroidManifest.txt");
                } catch (e) {
                    alert(data);
                }
            });
        });
    </script>
</body>
</html>